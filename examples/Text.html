<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />

    <title>gc.Text example</title>

    <script type="text/javascript" src="../src/polyfill.js"></script>
    <script type="text/javascript" src="../src/exception.js"></script>
    <script type="text/javascript" src="../src/util.js"></script>
    <script type="text/javascript" src="../src/Validator.js"></script>
    <script type="text/javascript" src="../src/validatorDefinitions.js"></script>
    <script type="text/javascript" src="../src/Canvas2D.js"></script>
    <script type="text/javascript" src="../src/Text.js"></script>
</head>

<body>

<canvas id="canvas" width="640" height="360" moz-opaque>
    Your browser doesn't support canvas.
    WHAT YEAR IS IT!???
</canvas>

<style type="text/css">
    canvas {
        border: 3px double black;
    }
</style>

<script type="text/javascript">

    function testLine(ctx, x, y, len, style) {
        ctx.strokeStyle = style;
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(x + len, y);
        ctx.closePath();
        ctx.stroke();
    };

    var canvas = new gc.Canvas2D(document.getElementById("canvas"));
    var ctx = canvas.getContext();
    ctx.font = "bold 48px Arial";
    var textMetrics = gc.Text.getTextMetrics(ctx.font);

    var text = "Text metrics: (Hg/憂鬱)";
    var w = ctx.measureText(text).width;
    var x = ctx.canvas.width - w - 10;
    var y = ctx.canvas.height - textMetrics.height - 10;
    ctx.textBaseline = 'top';
    ctx.fillText(text, x, y);

    testLine(ctx, x, y, w, 'red');
    testLine(ctx, x, y + textMetrics.ascent, w, 'green');
    testLine(ctx, x, y + textMetrics.height, w, 'blue');

    var escapeStrings = {
            s0: { font: "24px Arial",             fillStyle: "#000000", strokeStyle: null,      fill: true,  stroke: false },
            s1: { font: "36px Verdana",           fillStyle: "#0000ff", strokeStyle: null,      fill: true,  stroke: false },
            s2: { font: "bold 36px Arial",        fillStyle: "#000000", strokeStyle: null,      fill: true,  stroke: false },
            s3: { font: "36px sans-serif",        fillStyle: "#ff0000", strokeStyle: null,      fill: true,  stroke: false },
            s4: { font: "bold italic 48px Arial", fillStyle: "#ffff00", strokeStyle: "#000000", fill: true,  stroke: true  },
            s5: { font: "bold 36px Arial",        fillStyle: null,      strokeStyle: "#ff0000", fill: false, stroke: true  }
        };

    for(var s in escapeStrings) {
        gc.Text.registerAction(s, escapeStrings[s]);
    }

    gc.Text.setDefaultOptions({ style: escapeStrings.s0 });

    var texts = [{ bounds: "red",   text: "Text 1: Small and simple text" },
                 { bounds: "green", text: "\\s1Text \\s52\\s1: with\nnew lines" },
                 { bounds: "blue",  text: "Text 3: with \\s2change \\s3of \\s4format\\s0\nAND newlines" }];
    x = 10;
    y = 10;
    for(var i=0; i<texts.length; i++) {
        var txt = new gc.Text(texts[i].text);
        var textSize = txt.fullTextSize();
        ctx.strokeStyle = texts[i].bounds;
        ctx.strokeRect(x, y, textSize.width, textSize.height);
        txt.draw(ctx, x, y);
        y += 20 + textSize.height;
    }

</script>

</body>
</html>
